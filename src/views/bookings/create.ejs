<% if (!locals.user) { %>
    <div class="auth-required-container">
        <div class="auth-message">
            <i class="fas fa-lock"></i>
            <h2>Autenticación Requerida</h2>
            <p>Para realizar una reserva, necesitas iniciar sesión en tu cuenta.</p>
            <div class="auth-actions">
                <a href="/login?redirect=/reservas/crear" class="btn-login">Iniciar Sesión</a>
                <a href="/register?redirect=/reservas/crear" class="btn-register">Crear Cuenta</a>
            </div>
        </div>
    </div>
<% } else { %>
    <div class="booking-container">
        <div class="login-alert">
            <p>Debes iniciar sesión para realizar una reserva</p>
            <a href="/login">Iniciar Sesión</a>
        </div>
        <div class="booking-header">
            <h2>Reserva tu estancia</h2>
            <p>Descubre la tranquilidad y el encanto de nuestra casa rural</p>
        </div>
    
        <form id="bookingForm" method="POST" class="booking-form">
            <div class="form-group col-12">
                <label for="dateRange">
                    <i class="fas fa-calendar-alt"></i> Selecciona tus fechas de estancia
                </label>
                <input type="text" id="dateRange" name="dateRange" class="date-picker" placeholder="Selecciona entrada y salida" required>
            </div>
    
            <div class="guest-selector">
                <div class="guest-group">
                    <label for="adults">
                        <i class="fas fa-user"></i> Adultos
                    </label>
                    <input type="number" id="adults" name="adults" class="form-control" min="1" value="1" required>
                </div>
    
                <div class="guest-group">
                    <label for="children">
                        <i class="fas fa-child"></i> Niños
                    </label>
                    <input type="number" id="children" name="children" class="form-control" min="0" value="0">
                </div>
            </div>
    
            <div class="price-summary">
                <h3>Resumen de precios</h3>
                <div class="price-detail">
                    <span>Adultos (30€/persona)</span>
                    <span id="adultPrice">0€</span>
                </div>
                <div class="price-detail">
                    <span>Niños (15€/persona)</span>
                    <span id="childPrice">0€</span>
                </div>
                <div class="price-detail">
                    <span>Precio por noche</span>
                    <span id="pricePerNight">0€</span>
                </div>
                <div class="price-detail">
                    <span>Número de noches</span>
                    <span id="numberOfNights">0</span>
                </div>
                <div class="total-price">
                    <span>Total</span>
                    <span id="totalPrice">0€</span>
                </div>
            </div>
    
            <button type="submit" class="btn-primary">
                Continuar con la reserva
            </button>
        </form>
    </div>
    
    <%- include('../partials/bookingSummary') %>
    
    <script src="/js/booking.js"></script>
<% } %>